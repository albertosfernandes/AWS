aws ec2 describe-instances --filters "Name=tag:Name,Values=HISQL*" "Name=instance-state-code,Values=16" --query "Reservations[].Instances[].{InstanceId:[InstanceId,Tags[?Key=='Name'],BlockDeviceMappings[].Ebs[].{VolumeId:[VolumeId]}]}" --output text | grep VOLUMEID | awk '{print $2}' | while read line; do aws ec2 describe-volumes --volume-ids $line --query "Volumes[].{Attachments:Attachments[].{VolumeId:VolumeId},Tags:Tags[]}" >> /mnt/c/Alberto/reports-aws-cli/ec2-ebs/list-ec2-hisql-ebs.json; done;

aws ec2 describe-instances --filters "Name=tag:Name,Values=HISQL126*" "Name=instance-state-code,Values=16" --query "Reservations[].Instances[].{InstanceId:[InstanceId,Tags[?Key=='Name'],BlockDeviceMappings[].Ebs[].{VolumeId:[VolumeId]}]}" --output text | grep VOLUMEID | awk '{print $2}' | while read line; do aws ec2 describe-volumes --volume-ids $line --query "Volumes[].{Attachments:Attachments[].{VolumeId:VolumeId},Tags:Tags[]}" >> /mnt/c/Alberto/reports-aws-cli/ec2-ebs/list-ec2-hisql126-ebs.json; done;

